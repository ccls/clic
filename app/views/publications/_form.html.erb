<% form_for(@publication, :html => { :multipart => true }) do |f| %>
 <%= f.error_messages %>
 <%= f.wrapped_text_field :title, :class => 'autosize' %>
 <%= f.wrapped_text_field :author_last_name, :class => 'autosize' %>
 <%= f.wrapped_text_field :journal, :class => 'autosize' %>
 <%= f.wrapped_text_field :publication_year, :class => 'autosize' %>
 <%= f.wrapped_collection_select( :publication_subject_id, PublicationSubject.all,
  :id, :to_s, :include_blank => true) %>
 <%= f.wrapped_collection_select( :study_id, Study.all,
  :id, :to_s, :include_blank => true) %>


  <% @publication.group_documents.build if @publication.group_documents.empty? %>
  <% f.fields_for :group_documents do |d| %>
    <p>Optional File Attachment ...</p>
    <%= d.wrapped_text_field :title,
      :label_text => 'Document Title',
      :class => 'autosize' %>
    <%= d.wrapped_file_field :document %>
  <% end %>


 <p>
  <%= f.submit_link_to( ((@publication.new_record?)?'Create':'Update')<<" Publication" ) %>
  <% unless( @publication.new_record? ) %>
    <%= link_to 'Cancel and Show Publication', @publication, :class => 'button' %>
  <% end %>
  <%= link_to 'Cancel and Show Publications', publications_path, :class => 'button' %>
 </p>
<% end %>
